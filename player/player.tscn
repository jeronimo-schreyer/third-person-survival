[gd_scene load_steps=38 format=3 uid="uid://dwoy8b4fujdb5"]

[ext_resource type="Script" uid="uid://dbu5ktuokjttm" path="res://player/player.gd" id="1_oul6g"]
[ext_resource type="Script" uid="uid://couw105c3bde4" path="res://addons/godot_state_charts/state_chart.gd" id="2_yw30f"]
[ext_resource type="Script" uid="uid://jk2jm1g6q853" path="res://addons/godot_state_charts/compound_state.gd" id="3_qjkh3"]
[ext_resource type="Script" uid="uid://cytafq8i1y8qm" path="res://addons/godot_state_charts/atomic_state.gd" id="4_g6k8r"]
[ext_resource type="Script" uid="uid://cf1nsco3w0mf6" path="res://addons/godot_state_charts/transition.gd" id="5_g6k8r"]
[ext_resource type="Script" uid="uid://le5w1cm0ul8p" path="res://addons/godot_state_charts/expression_guard.gd" id="6_boad6"]
[ext_resource type="PackedScene" uid="uid://dtrhxk28ispmj" path="res://player/model/PolygonSyntyCharacter.fbx" id="8_hg6s5"]
[ext_resource type="Animation" uid="uid://bvav1ujiulfhk" path="res://player/animations/idle/A_Idle_Standing_Masc.anim" id="9_8t03j"]
[ext_resource type="Animation" uid="uid://cvo47qpctd86l" path="res://player/animations/walk/A_Walk_F_Masc.anim" id="10_2ieo8"]
[ext_resource type="Animation" uid="uid://b6ow2cnpjk2oy" path="res://player/animations/fall/A_InAIr_FallShort_Masc.anim" id="12_ebec5"]
[ext_resource type="Animation" uid="uid://cvkcjmn72gev8" path="res://player/animations/idle/A_Idle_Crouching_Masc.anim" id="12_yllr7"]
[ext_resource type="Animation" uid="uid://b17ip088g2kwj" path="res://player/animations/walk/A_POLY_BL_Crouch_FwdStrafeF_Masc.anim" id="13_kb6p2"]
[ext_resource type="Animation" uid="uid://q3qr4j3t8e51" path="res://player/animations/run/A_Run_F_Masc.anim" id="13_yllr7"]

[sub_resource type="Resource" id="Resource_2ieo8"]
script = ExtResource("6_boad6")
expression = "!is_on_floor"
metadata/_custom_type_script = "uid://le5w1cm0ul8p"

[sub_resource type="Resource" id="Resource_ebec5"]
script = ExtResource("6_boad6")
expression = "velocity.length() > 0.1"
metadata/_custom_type_script = "uid://le5w1cm0ul8p"

[sub_resource type="Resource" id="Resource_yllr7"]
script = ExtResource("6_boad6")
expression = "velocity.length() <= 0.1"
metadata/_custom_type_script = "uid://le5w1cm0ul8p"

[sub_resource type="Resource" id="Resource_kb6p2"]
script = ExtResource("6_boad6")
expression = "is_on_floor"
metadata/_custom_type_script = "uid://le5w1cm0ul8p"

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_g1dw6"]
radius = 0.24
height = 1.8

[sub_resource type="Animation" id="Animation_yllr7"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("../CollisionShape3D:shape:radius")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.24]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../CollisionShape3D:shape:height")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [1.8]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("../CollisionShape3D:position")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0, 0.9, 0)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_kb6p2"]
_data = {
&"RESET": SubResource("Animation_yllr7")
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_2ieo8"]
_data = {
&"Crouching Idle": ExtResource("12_yllr7"),
&"Crouching Walk": ExtResource("13_kb6p2"),
&"Fall": ExtResource("12_ebec5"),
&"Run": ExtResource("13_yllr7"),
&"Standing Idle": ExtResource("9_8t03j"),
&"Standing Walk": ExtResource("10_2ieo8")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_2ieo8"]
animation = &"Player/Fall"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_wodsf"]
animation = &"Player/Crouching Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_32hag"]
animation = &"Player/Crouching Walk"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_2ieo8"]
blend_point_0/node = SubResource("AnimationNodeAnimation_wodsf")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("AnimationNodeAnimation_32hag")
blend_point_1/pos = 0.5

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ebec5"]
animation = &"Player/Standing Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_yllr7"]
animation = &"Player/Standing Walk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_kb6p2"]
animation = &"Player/Run"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_wodsf"]
blend_point_0/node = SubResource("AnimationNodeAnimation_ebec5")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("AnimationNodeAnimation_yllr7")
blend_point_1/pos = 0.5
blend_point_2/node = SubResource("AnimationNodeAnimation_kb6p2")
blend_point_2/pos = 1.0

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_32hag"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_tqiix"]
xfade_time = 0.1
advance_mode = 2
advance_condition = &"is_crouched"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_e7oew"]
xfade_time = 0.1
advance_mode = 2
advance_condition = &"is_standing"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_65viv"]
states/Start/position = Vector2(200.5, 101.25)
states/crouch/node = SubResource("AnimationNodeBlendSpace1D_2ieo8")
states/crouch/position = Vector2(507.094, 235.5)
states/stand/node = SubResource("AnimationNodeBlendSpace1D_wodsf")
states/stand/position = Vector2(506.875, 99.5)
transitions = ["Start", "stand", SubResource("AnimationNodeStateMachineTransition_32hag"), "stand", "crouch", SubResource("AnimationNodeStateMachineTransition_tqiix"), "crouch", "stand", SubResource("AnimationNodeStateMachineTransition_e7oew")]
graph_offset = Vector2(22, 47)

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_x7c3f"]
advance_mode = 2
advance_condition = &"is_falling"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_bjvpn"]
advance_mode = 2
advance_condition = &"is_grounded"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_s7qer"]
advance_mode = 2
advance_condition = &"is_grounded"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_c35mf"]
states/Start/position = Vector2(201, 99.5)
states/fall/node = SubResource("AnimationNodeAnimation_2ieo8")
states/fall/position = Vector2(476.5, -22.5)
states/ground/node = SubResource("AnimationNodeStateMachine_65viv")
states/ground/position = Vector2(477.75, 102.25)
transitions = ["ground", "fall", SubResource("AnimationNodeStateMachineTransition_x7c3f"), "fall", "ground", SubResource("AnimationNodeStateMachineTransition_bjvpn"), "Start", "ground", SubResource("AnimationNodeStateMachineTransition_s7qer")]
graph_offset = Vector2(-97, -53)

[node name="Player" type="CharacterBody3D"]
floor_stop_on_slope = false
floor_constant_speed = true
floor_block_on_wall = false
floor_max_angle = 0.942478
floor_snap_length = 0.24
script = ExtResource("1_oul6g")
_acceleration = 10.0
_walk_speed = 1.3
_run_speed = 2.7

[node name="States" type="Node" parent="."]
script = ExtResource("2_yw30f")
metadata/_custom_type_script = "uid://couw105c3bde4"

[node name="Root" type="Node" parent="States"]
script = ExtResource("3_qjkh3")
initial_state = NodePath("Grounded")

[node name="Grounded" type="Node" parent="States/Root"]
script = ExtResource("3_qjkh3")
initial_state = NodePath("Idle")

[node name="ToAirborne" type="Node" parent="States/Root/Grounded"]
script = ExtResource("5_g6k8r")
to = NodePath("../../Airborne")
guard = SubResource("Resource_2ieo8")
delay_in_seconds = "0.0"

[node name="Idle" type="Node" parent="States/Root/Grounded"]
script = ExtResource("4_g6k8r")

[node name="ToMoving" type="Node" parent="States/Root/Grounded/Idle"]
script = ExtResource("5_g6k8r")
to = NodePath("../../Moving")
guard = SubResource("Resource_ebec5")
delay_in_seconds = "0.0"

[node name="Moving" type="Node" parent="States/Root/Grounded"]
script = ExtResource("4_g6k8r")

[node name="ToIdle" type="Node" parent="States/Root/Grounded/Moving"]
script = ExtResource("5_g6k8r")
to = NodePath("../../Idle")
guard = SubResource("Resource_yllr7")
delay_in_seconds = "0.0"

[node name="Airborne" type="Node" parent="States/Root"]
script = ExtResource("4_g6k8r")

[node name="ToGrounded" type="Node" parent="States/Root/Airborne"]
script = ExtResource("5_g6k8r")
to = NodePath("../../Grounded")
guard = SubResource("Resource_kb6p2")
delay_in_seconds = "0.0"

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.9, 0)
shape = SubResource("CapsuleShape3D_g1dw6")

[node name="Armature" parent="." instance=ExtResource("8_hg6s5")]

[node name="Skeleton3D" parent="Armature" index="0"]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)
bones/1/position = Vector3(0, 0.876276, 0)

[node name="AnimationPlayer" type="AnimationPlayer" parent="Armature"]
libraries = {
&"": SubResource("AnimationLibrary_kb6p2"),
&"Player": SubResource("AnimationLibrary_2ieo8")
}

[node name="AnimationTree" type="AnimationTree" parent="."]
root_node = NodePath("../Armature")
tree_root = SubResource("AnimationNodeStateMachine_c35mf")
anim_player = NodePath("../Armature/AnimationPlayer")
parameters/conditions/is_falling = false
parameters/conditions/is_grounded = false
parameters/ground/conditions/is_crouched = false
parameters/ground/conditions/is_standing = false
parameters/ground/crouch/blend_position = 0
parameters/ground/stand/blend_position = 0.0

[connection signal="state_entered" from="States/Root/Grounded" to="." method="_on_grounded_state_entered"]
[connection signal="state_physics_processing" from="States/Root/Grounded" to="." method="_on_grounded_state_physics_processing"]
[connection signal="state_unhandled_input" from="States/Root/Grounded" to="." method="_on_grounded_state_unhandled_input"]
[connection signal="state_entered" from="States/Root/Airborne" to="." method="_on_airborne_state_entered"]

[editable path="Armature"]
